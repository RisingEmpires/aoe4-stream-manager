{"version":3,"file":"migration/1669424781583-default-roles.js","mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;;;;;;;;;;;;;;;ACVA,kEAAkE;AAClE,gEAA4E;AAC5E,yFAA8B;AAE9B,IAAkB,MAIjB;AAJD,WAAkB,MAAM;IACvB,mCAAQ;IACR,mCAAa;IACb,qCAAc;AACf,CAAC,EAJiB,MAAM,GAAN,cAAM,KAAN,cAAM,QAIvB;AAGM,IAAM,UAAU,GAAhB,MAAM,UAAU;CAetB;AAdA;IAAC,oCAAsB,EAAC,MAAM,CAAC;;sCACnB;AAEZ;IAAC,oBAAM,EAAC,MAAM,CAAC;;wCACD;AAEd;IAAC,uBAAS,EAAC,GAAG,EAAE,CAAC,WAAI,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC;kDAC3C,WAAI,oBAAJ,WAAI;wCAAC;AAEZ;IAAC,oBAAM,EAAC,MAAM,CAAC;;4CACG;AAElB;IAAC,oBAAM,EAAC,KAAK,CAAC;;2CACG;AAdL,UAAU;IADtB,oBAAM,GAAE;GACI,UAAU,CAetB;AAfY,gCAAU;;;;;;;;;;;;;;;;;;;;;;;ACXvB,gEAA4E;AAC5E,2GAA0C;AAGnC,IAAM,IAAI,GAAV,MAAM,IAAI;CAYhB;AAXA;IAAC,oCAAsB,EAAC,MAAM,CAAC;;gCACnB;AAEZ;IAAC,oBAAM,EAAC;QACP,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE,IAAI;KACZ,CAAC;;kCACY;AAEd;IAAC,uBAAS,EAAC,GAAG,EAAE,CAAC,uBAAU,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC;;yCAClC;AAXf,IAAI;IADhB,oBAAM,GAAE;GACI,IAAI,CAYhB;AAZY,oBAAI;;;;;;;;;;;;;;;;;;;;;;;ACHjB,mHAA8C;AAE9C,MAAM,OAAO,GAAG,sCAAsC,CAAC;AACvD,MAAM,aAAa,GAAG,sCAAsC,CAAC;AAE7D,MAAa,yBAAyB;IAC/B,EAAE,CAAC,WAAwB;;YAChC,MAAM,WAAW,CAAC,KAAK,CAAC,wCAAwC,OAAO,kBAAkB,CAAC,CAAC;YAC3F,MAAM,WAAW,CAAC,KAAK,CACtB,sFAAsF,aAAa,OAAO,OAAO,WAChH,mBAAM,CAAC,IAAI,GAAG,mBAAM,CAAC,KACtB,IAAI,CACJ,CAAC;QACH,CAAC;KAAA;IAEK,IAAI,CAAC,WAAwB;;YAClC,MAAM,WAAW,CAAC,KAAK,CAAC,gCAAgC,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;YACrE,MAAM,WAAW,CAAC,KAAK,CAAC,sCAAsC,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC;QAClF,CAAC;KAAA;CACD;AAdD,8DAcC;;;;;;;;;;;ACpBD;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://nodecg/webpack/universalModuleDefinition","webpack://nodecg/./src/server/database/entity/Permission.ts","webpack://nodecg/./src/server/database/entity/Role.ts","webpack://nodecg/./src/server/database/migration/1669424781583-default-roles.ts","webpack://nodecg/external commonjs \"typeorm\"","webpack://nodecg/webpack/bootstrap","webpack://nodecg/webpack/before-startup","webpack://nodecg/webpack/startup","webpack://nodecg/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(global, () => {\nreturn ","/* eslint-disable @typescript-eslint/prefer-literal-enum-member */\nimport { Entity, PrimaryGeneratedColumn, Column, ManyToOne } from 'typeorm';\nimport { Role } from './Role';\n\nexport const enum Action {\n\tNONE = 0,\n\tREAD = 1 << 0,\n\tWRITE = 1 << 1,\n}\n\n@Entity()\nexport class Permission {\n\t@PrimaryGeneratedColumn('uuid')\n\tid!: string;\n\n\t@Column('text')\n\tname!: string;\n\n\t@ManyToOne(() => Role, (role) => role.permissions)\n\trole!: Role;\n\n\t@Column('text')\n\tentityId!: string;\n\n\t@Column('int')\n\tactions!: number;\n}\n","import { Entity, PrimaryGeneratedColumn, Column, OneToMany } from 'typeorm';\nimport { Permission } from './Permission';\n\n@Entity()\nexport class Role {\n\t@PrimaryGeneratedColumn('uuid')\n\tid!: string;\n\n\t@Column({\n\t\ttype: 'text',\n\t\tunique: true,\n\t})\n\tname!: string;\n\n\t@OneToMany(() => Permission, (permission) => permission.role)\n\tpermissions!: Permission[];\n}\n","import { type MigrationInterface, type QueryRunner } from 'typeorm';\nimport { Action } from '../entity/Permission';\n\nconst ROLE_ID = '07e18d80-fa74-4d98-ac18-838c745a480f';\nconst PERMISSION_ID = '923561ef-4186-4370-b7df-f12e64fc7bd2';\n\nexport class defaultRoles1669424781583 implements MigrationInterface {\n\tasync up(queryRunner: QueryRunner): Promise<void> {\n\t\tawait queryRunner.query(`INSERT INTO role (id, name) VALUES ('${ROLE_ID}', 'superuser');`);\n\t\tawait queryRunner.query(\n\t\t\t`INSERT INTO permission (name, id, roleId, entityId, actions) VALUES ('superuser', '${PERMISSION_ID}', '${ROLE_ID}', '*', ${\n\t\t\t\tAction.READ | Action.WRITE\n\t\t\t});`,\n\t\t);\n\t}\n\n\tasync down(queryRunner: QueryRunner): Promise<void> {\n\t\tawait queryRunner.query(`DELETE FROM role WHERE id='$1'`, [ROLE_ID]);\n\t\tawait queryRunner.query(`DELETE FROM permission WHERE id='$1'`, [PERMISSION_ID]);\n\t}\n}\n","module.exports = require(\"typeorm\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/server/database/migration/1669424781583-default-roles.ts\");\n",""],"names":[],"sourceRoot":""}